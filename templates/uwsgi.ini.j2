# This file was generated by Ansible for {{ansible_fqdn}}
# Do NOT modify this file by hand!

{% set app = item %}
{% set run_dir = app.run_dir|default(wsgi_run_dir) -%}

[uwsgi]
chdir = {{app.app_dir|default(wsgi_app_dir)}}
chmod-socket = 777
chown-socket = {{wsgi_user}}
die-on-term = true
enable-threads = {{ 'true' if wsgi_uwsgi_enable_threads else 'false' }}
log-master = true
logto = {{app.log_dir|default(wsgi_log_dir)}}/{{app.name}}-wsgi.log
master = true
max-requests = {{wsgi_uwsgi_max_requests}}
no-orphans = {{ 'true' if wsgi_uwsgi_no_orphans else 'false' }}
processes = {{app.uwsgi_processes|default(wsgi_uwsgi_processes)}}
socket = {{app.socket|default(run_dir + '/' + app.name)}}
uid = {{wsgi_user}}
vaccuum = true
virtualenv = {{app.virtualenv|default(wsgi_virtualenv)}}
{% if app.module|default(None) -%}
module = {{app.module|default('')}}
{% else %}
file = {{app.file|default(wsgi_app_dir + '/wsgi.py')}}
{% endif %}
{% if wsgi_uwsgi_cpu_affinity is defined -%}
cpu-affinity = {{ wsgi_uwsgi_cpu_affinity }}
{% endif %}
{% if wsgi_uwsgi_limit_as is defined -%}
limit-as = {{wsgi_uwsgi_limit_as}}
{% endif %}
{% if wsgi_reload -%}
py-autoreload = true
touch-reload = {{app.app_dir|default(wsgi_app_dir)}}
{% endif %}
{% for option in app.uwsgi_options|default(wsgi_uwsgi_options) %}
{{option}}
{% endfor -%}
